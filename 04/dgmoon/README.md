# 4장 컴퓨터 내부 구조

컴퓨터: 전자 부품을 다양하게 조합해 비트를 조작하는 회로

- 메모리, I/O, CPU로 나뉨

## 메모리

메모리: 비트 저장 장소

- 비트 저장소와 주소(메모리 위치)
- 메모리의 기본단위는 바이트, but 읽기 단위는 4바이트(32비트 컴퓨터)일수도 8바이트(64비트 컴퓨터)일 수도 있음
- 포플렉스, 듀플렉스 구조 - 한번에 4개 비트씩 이동
    - 최근에는 정렬이 맞지 않는 접근도 가능
    - 메모리마다 가성비가 다름

## 입력과 출력

I/O: 정보를 가져오기 위한 방법. I/O에 연결되는 장치를 I/O장치, 주변장치라고도 부름.

- 예전에는 I/O 버스 경로와 메모리 버스 경로를 분리 했으나 메모리 주소 수가 많아진 현재는 그렇지 않음(같은 버스 사용)
- 표준 I/O 슬롯이 있어서 일관된 방식으로 I/O장치 연결 가능

## 중앙 처리 장치(CPU)

### 산술 논리 장치(ALU)

- 수를 표현하는 비트인 피연산자(operand)를 받아 연산자인 명령 코드(opcode)에 따라 연산 후 결과 출력
- 조건 코드 레지스터에 결과에 대한 추가 정보인 조건 코드가 저장됨
- 레지스터는 메모리 버스가 아닌 곳에 존재하는 특별하고 더 비싼 메모리

### 시프트

- 왼쪽 시프트(X2), 오른쪽 시프트(/2)
- 시프트 명령어를 제외한 ALU 모든 기능은 조합 논리로 구현 가능
- 시프트 레지스터(시프터)를 플립플롭 사용해 만들 수 있음
- 시프터는 부동소수점 연산 구현할 때도 핵심 부품임
    - 두 피연산자의 가수를 지수에 따라 시프트함으로써 소수점 정렬 후 더하거나 뺌

### 실행 장치(EU, 제어장치, CU)

- 메모리에 명령어를 저장하고 찾을 수 있어야 함
    - 앨런 튜링의 프로그램 저장 방식 컴퓨터
- 프로그램 카운터(PC): 명령어의 위치를 알 수 있음(메모리 주소가 들어 있음)

## 명령어 집합

### 명령어

- 명령어를 명령코드, 피연산자 A, B, 결과 4가지 필드로 나누는 것(3 주소 명령어)은 그다지 유용하지 않음
    - 결과와 피연산자 주소에 4비트 밖에 쓸 수 없기 때문
    - 주소 확장 레지스터를 두고 별도 명령어를 사용해 상위 주소 지정하기도 함
        - 여러 번 레지스터 설정 필요
    - 3주소 명령어는 세가지 메모리 위치를 한꺼번에 지정함
        - 연산 결과를 다른 연산에 활용하려면 이동 위한 별도 명령어 필요
        - CPU 패키지 입출력 핀 수가 제한돼 있어 CPU 안 늘리려면 세 버스가 같은 핀 공유하고 다른 클록에 작동하는 수밖에 없음
        - 근데 이러면 버스를 3벌이나 둘 필요 없고 따라서 데이터 버스와 주소 버스를 하나만 두고 메모리 장치를 공유해야 함
        - 이러면 회로가 아주 복잡해짐
        - 해결책: 누산기(accumulator, A 레지스터) 추가 -> 1주소 명령어 체계 사용

### 주소 지정 모드

- 직접 주소 지정, 간접 주소 지정
- 직접 주소 지정 사용 시 사용 가능한 주소 부족
- 간접 주소 지정: 더많은 메모리 사용 가능
    - 명령어에 들어 있는 값을 피연산자 주소로 해석하지 않고 피연산자 주소를 얻을 수 있는 메모리 위치를 가리키는 주소로 사용
- 즉시 주소 지정 모드: 상수 지정 시 사용. 주소를 지정하지 않고 직접 값을 지정하는 모드.
    - 직접 주소 지정은 즉시 주소 지정보다 느림
    - 간접 주소 지정은 더더욱 느림

### 조건 코드 명령어

조건 코드 레지스터 값 누산기로 복사 -> cca 명령어
누산기 값을 레지스터에 복사 -> acc 명령어

### 분기 명령어

- 분기 명령어: 프로그램 카운터의 값을 변경할 수 있는 명령어

### 최종 명령어 집합 구성

- 모드(주소 지정 모드), 명령코드, 주소
- 프로그램: 어떤 목표를 달성하는 일련의 명령어

## 마지막 설계

### 명령어 레지스터

- 명령어 가져오기(페치), 실행 두 단계로 이뤄진 상태 기계
- 명령어 레지스터: 페치한 명령어에 쉽게 접근하기 위해 현재 실행 중인 명령어 저장

### 데이터 경로와 제어 신호

- 프로그램 카운터 값을 메모리 주소버스에 넣을 방법, 메모리에 있는 데이터를 명령어 레지스터로 넣을 방법을 위해 연결 필요
- 간접 주소 레지스터: 간접 주소 지정을 사용할 때 메모리에서 읽어온 주소를 l저장해야 하는데 사용

### 데이터 흐름 제어

입력과 출력 사이에 발생하는 데이터의 교통을 제어하는 장치 만들기

## RISC와 CISC 명령어 집합

- 복잡한 명령어 중 상당 수는 사용되지 않음 -> 단순한 명령어만을 조합해 처리하는 기계 -> RISC
- 기존의 복잡한 명령어 사용 컴퓨터는 CISC
- 적재 저장 구조 사용
- but, RISC도 시간이 지나면서 새로운 명령어가 추가되고 좀 더 복잡해짐

## GPU

- 그래픽 처리는 특화된 작업이기 때문에 일반적인 용도에 사용할 CPU가 제공하는 모든 기능 필요하지 않음
- 그래픽 작업은 병렬화하기 좋음
- GPU 특징
    - 간단한 처리장치가 아주 많이 들어 있음
    - CPU보다 메모리 버스의 폭이 더 넓음


