# 애플리케이션 프로그래밍과 시스템 프로그래밍

운영체제는 사용자 프로그램이 I/O 장치의 복잡도를 상당 부분 볼 수 없게 가려준다. <br>
비슷한 방식으로 , 브라우저 같은 복잡한 사용자 프로그램은 그 프로그램 위에 만들어진 다른 애플리케이션 프로그램들이 운영체제를 다루는 복잡도를 볼 수 없게 가려준다.

## C 프로그램

### 프로그램 빌드

C는 컴파일 언어이기 때문에 자바스크립트를 인터프리터로 실행했던 것처럼 그냥 소스 코드를 실행할 수는 없다. <br>
소스 코드를 먼저 기계어로 변환해야 한다. 명령줄에서 쉽게 이런 변환을 할 수 있다. <br>
소스 파일의 이름이 hta.c라면, `cc cta.c -o gta`명령을 터미널에 쳐서 gta라는 기계어 파일을 생성할 수 있다.

### 터미널과 장치 드라이버

터미널은 I/O 장치이며, 사용자 프로그램은 직접 I/O 장치와 통신하지 않는다. 운영체제가 중간에서 통신을 중재한다.

### 문맥 전환

컴퓨터는 레지스터 집합이 하나뿐이므로 운영체제는 한 사용자 프로그램을 다른 사용자 프로그램으로 바꿀 때마다 레지스터들을 저장하고 복구해야 한다. <br>
CPU 레지스터 외에도 저장하고 복구해야 할 내용이 많다. 예를 들어, MMU 레지스터나 I/O 상태 등도 저장하고 복구해야 한다. <br>
이 때 저장하고 복구해야 하는 모든 내용을 프로세스 문맥이라고 한다. <br>
문맥이 커서 문맥 전환 비용이 비싸기 때문에, 자주하고 싶지는 않다.

<img width="778" alt="스크린샷 2024-09-29 오후 12 53 20" src="https://github.com/user-attachments/assets/85699985-82ab-47fb-b96e-809a46ecca08">

사용자가 키를 누를 때마다 문맥 전환이 일어나기를 바라지는 않는다. 이런 경우 문맥 전환 횟수를 최소화하기 위해서는 사용자가 ENTER를 누를 때까지는 사용자가 무엇을 타이핑하든 상관없다는 점을 알아야 한다. <br>
사용자 프로그램은 시스템 콜을 사용해 터미널에서 입력을 읽고싶다는 의사를 표시한다. <br>
물리적 장치와 관련한 처리를 담당하는 장치 드라이버는 터미널에서 들어오는 문자를 버퍼에 저장하고, 사용자가 키를 누를 때가 아니라 ENTER를 누를 때에만 사용자 프로그램을 깨운다.

### 표준 I/O

사용자 프로그램이 문자를 기록하기 위해 매번 시스템 콜을 호줄하면 장치 드라이버에 줄력 버퍼가 아무 역할도 못한다. <br>
이런 상황이 자주 있기 때문에 표준 입력/출력 라이브러리 (stdio)가 만들어졌다. <br>
표준 입출력 라이브러리에는 사용자 프로그램이 쓸 수 있는 버퍼 I/O 함수가 들어 있다.

stdio 라이브러리는 버퍼 입력을 지원한다. 버퍼 입력을 사용하면 시스템 콜을 한 번만 사용해 장치 드라이버에서 읽은 데이터를 버퍼에 넣을 수 있다. <br>
사용자 프로그램은 버퍼가 빌 때까지 버퍼에서 입력 문자를 얻는다. 버퍼가 소진되면 다시 시스템 콜을 통해 입력을 더 가져온다.

<img width="644" alt="스크린샷 2024-09-29 오후 12 57 01" src="https://github.com/user-attachments/assets/84744227-4cc2-4090-ae23-f5c9b0bfedab">


### 런타임 라이브러리와 표준 입출력

C 프로그램을 실행하려면 우리가 작성한 코드를 컴파일한 다음, 컴파일된 코드와 이 코드가 사용하는 stdio 라이브러리 등의 다른 코드를 링크해야 한다. <br>
런타임 라이브러리는 스택과 힙을 설정해서 사용할 수 있도록 준비하는 등의 설정을 담당한다. <br>
런타임 라이브러리는 추가로 터미널 장치 드라이버와 연관된 파일을 하나는 입력을 위해, 다른 하나는 출력을 위해 연다.










